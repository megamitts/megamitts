pico-8 cartridge // http://www.pico-8.com
version 42
__lua__

-- music by gruber

poos = {}   -- poos array
	


player = {
    x=64,
    y=64,
    facing_left=0,
    width = 16,
    height = 16
    }


carrot = {
    x = 0,
    y = 0,
    radius = 4,
    active = false,
    lifetime = 0,  -- track how long carrot has existed
    max_lifetime = 30 * 3  -- 30 fps * 3 seconds
}


timer = 0
score = 0
farmer_timer = 0
farmer_show = 0


function _init()
    music(0)
    intro()
    spawn_carrot()
    
end

function _update()
    if btn(⬅️) then 
        player.x-=1 
        player.facing_left = 1 
        
    end
    if btn(➡️) then 
        player.x+=1 
        player.facing_left = 0
        
         
    end
    if btn(⬇️) then player.y+=1 end
    if btn(⬆️) then player.y-=1 end
    
    if btn(❎) then 
        sfx(33) -- laser sound
        -- store the exact position where we want the poo to appear
        local poo_x = player.x
        if player.facing_left == 1 then
            poo_x = poo_x + 16  -- offset for facing left
        else
            poo_x = poo_x - 8   -- offset for facing right
        end
        
        add(poos, {
            x = poo_x,
            y = player.y + 8   -- store the final y position
        })
    end
    
    player.x = mid(0, player.x, 110) -- max x positions
    player.y = mid(0, player.y, 113)  -- max y positions

				-- carrot spawn timer
    if not carrot.active then
        timer += 1
        if timer >= 30*5 then -- 30 fps * 5 seconds
            spawn_carrot()
            timer = 0
        end
    else
        -- update carrot lifetime
        carrot.lifetime += 1
        if carrot.lifetime >= carrot.max_lifetime then
            carrot.active = false
            carrot.lifetime = 0
        end
    end

				-- collision check
    if carrot.active and check_collision() then
        carrot.active = false
        carrot.lifetime = 0
        score += 1
    end

end

function _draw()
    
    cls(11)
    --print(farmer_timer, 0,10)
    
    
    
    farmer_timer += 1
    if farmer_timer == 30*10 then
    sfx(32,3)
    farmer_show = 1 
    end
    if farmer_timer == 30*20 then
    sfx(-2,3)
    farmer_timer = 0
    farmer_show = 0
    end
    
				-- draw carrot if active
    if carrot.active then
        spr(6, carrot.x, carrot.y)
				end

				print("score: "..score, 2, 2, 0)

    -- draw all poos at their stored positions
    for poo in all(poos) do
        spr(5, poo.x, poo.y)
    end
    
    -- draw the rabbit
    if player.facing_left == 1 then
        spr(1, player.x, player.y, 2, 2)
    else
        spr(1, player.x, player.y, 2, 2, true)    
    end
				
				-- draw farmer
				
				if farmer_show == 1 then
    spr(9,64,64,2,4)
    end
    
				if score == 2 then
				game_over_win()
				repeat
  		flip()
				until btn(4)
				-- restart the game
				timer = 0
				farmer_timer = 0
				score = 0
				farmer_show = 0
				music(0)
				poos = {}
				end
				
end

function spawn_carrot()
	carrot.x = flr(rnd(120))+4
	carrot.y = flr(rnd(120))+4
	carrot.active = true
	carrot.lifetime = 0
end

function check_collision()
    -- rabbit vs carrot collision
    local closest_x = mid(player.x, carrot.x, player.x + player.width)
    local closest_y = mid(player.y, carrot.y, player.y + player.height)
    
    local dist_x = carrot.x - closest_x
    local dist_y = carrot.y - closest_y
    
    return (dist_x * dist_x + dist_y * dist_y) <= (carrot.radius * carrot.radius)
end

function game_over_win()
	cls(7)
	print("you have scoffed all the carrots!", 0, 10,0)
	sfx(-1)
	music(-1, 300)
	
	print("press 🅾️ to restart")

	
end	

function intro()
cls(7)
print("farmer smith's carrots are all")
print("juicy and ripe for the eating")


print("press 🅾️ to start")
repeat
  flip()
until btn(4)
end
__gfx__
00000000000000000000000000000000000000000000000000033000000000550000000000000555550000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000033000000000550000000000005555555500000000000000000000000000000000000000000000
0070070000070700000000000000000000000000000000000033330000000005000000000005eeeeee5000000000000000000000000000000000000000000000
0007700000777770000000000000000000000000004444000999999000000000000000000005effffff000000000000000000000000000000000000000000000
0007700000777770000000000000000000000000004444000999999000000000000000000005f1ffff1000000000000000000000000000000000000000000000
007007000777777000000000000000000000000004444440009999000000000000000000000efffffef000000000000000000000000000000000000000000000
000000007777777777000000000000000000000044444444009999000000000000000000000ffffffef000000000000000000000000000000000000000000000
00000000777a7777777000000000000000000000444444440009900000000000000000000000fffddff000000000000000000000000000000000000000000000
00000000777a77777777ff000000000000000000000000000000000000000000000000000008cfffffc800000000000000000000000000000000000000000000
00000000777777777777ff000000000000000000000000000000000000000000000000000008c8fff8c800000000000000000000000000000000000000000000
0000000007777777777770000000000000000000000000000000000000000000000000000088c88888c880000000000000000000000000000000000000000000
0000000000077777777770000000000000000000000000000000000000000000000000000088a88888a880000000000000000000000000000000000000000000
00000000007777777777700000000000000000000000000000000000000000000000000000888ccccc8880000000000000000000000000000000000000000000
00000000007770007777000000000000000000000000000000000000000000000000000000888ccccc8880000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000888ccccc8880000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000888ccccc8880000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000088111a111880000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000881111111880000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000ff1111111ff0000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000001110111000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000044440444400000000000000000000000000000000000000000000
__sfx__
480100010c17018705000000000023000000002300024000000000000025000000000000025000000002500025000250002500025000250002500025000250000000000000000000000000000000000000000000
050700000c06300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
010102030000000000180701800500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
390101020000018050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
410101020000018050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4b0800003062500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0112000011a4505845058050ca250ea450000010a450584513a3511a4511a2510a3511a45058450583515a450000013a4513a2512a4513a25078450783516a350c82515a4515a2514a4515a250c8450ea2510a45
01120000189601dc141dd152171424e4521714245151dc1418960247153070121c1524e45265142471518960297152651522c151871424e4522c14245141896026515247141dc151ad1524e4520714217141dc15
0112000011a4505845098450ca250ea450000010a450584513a2511a4510a250ea450ca35188450c8450aa450a84516a4515a3513a4516a350ea45078450ca450c8450ba450ca350ea4510a250c8450ea2510a45
0112000011a4505845098450ca250ea450000010a450584513a2511a4510a350ea350ca45188350c8250aa450a84516a2515a4513a3516a451aa350c84515a45118450ca4509a3507a4505a25058451da1505845
00120000189601dc141dd152171424e4521714245151dc1418960247153070121c1524e45265142471518960297152651522c151871424e4522c141896029c15357011dc141dd151893024e45187141896021515
0112000016a450a8450a80511a2513a450500015a350a84518a2516a4516a3515a4516a350a8450a8351aa450500018a4518a2517a3518a450c8450c8351ba45000001aa451ba251fa351da451aa051fa3521a45
011200001896022c1422d152671424e452671422c1518e15189601d7152970126c1524e4529c1425e0518e25189601f51527c151d71424e4527c141d514189601dc152971422c151fd1524e45257142671424e25
0112000022a451aa351aa2519a351aa4500a0000a0021a4500a001fa451fa251ea351fa4500a0000a0020a4500a0018a3518a4517a3518a4500a0000a001fa4500a001da451ca251fa351da4500a0000a001fa45
01120000189600784522c1526d1424e4522c152d7010c8451896026d15185150c51524e452171522715189601184520d1420c1524d1424e4520c152b701189600a84524d15227151671524e450a8450c8450e845
011200001896022c1422d152671424e45267141d51518e1518960297153570126c1524e451fc142971518960227151f51527c151d71424e4527c141dc14189601f5151d71422c151fd1524e45257142671422c15
0112000016a450a8450e84511a3513a450500015a350a84518a2516a4515a3513a4511a351d825118450fa350f8451ba451aa2518a451ba3513a450c84511a451184510a4511a2513a4515a3511a4513a2515a35
0112000016a450a8450a80511a3513a450500015a250a84518a2516a4516a4515a3516a450a8450a8351aa450500018a4518a2517a3518a450c8450c8351ba45000001aa451aa3519a451aa251a00513a2515a35
011200001896022c1422d152671424e45267142951518e1518960297153570126c1524e451dc2525e0518e25189602b51527c151d71424e4527c1429c15189601d5152271422c151fd1524e45257142671418e25
011200001896016a3516a4515a3516a451f7152b7011ea351484516a3516a4515a3516a451e7152a7011da350a82516a3516a4515a3516a451d7152970115a4513a2515a4516a3517a4518a2516a4515a3513a45
011200000f8451fc150a8451893024e451fc1518e051ec1518960088450f8451ec1524e45038251251418e251896005845168451893024e451ac15168451896024e45078451893022c1524e450c8450e84510845
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0110000018000180011a0001c0001d0001f000210001f0001d0001c0001a0001c0001d0001d0011d0021a0001c0001d0001f0001f00021000210001f0001d0001c0001c0001a0001a0001a000180001800018000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0112000016045168450a84511045130450a845150450a83518045160451604515045160450984515045130451204513045150451604502805150451304512045000000e045100451204512845180451604515045
011200001896022c1422d152671424e45267142951522c1418960297153570126c1524e452b51429715189600e84522d151ac140284524e451a7151871518960225151ac142650122d1524e450e8450284522c05
001b00040237005370073700337000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000
001000000527006250272000020000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000022000020000000
__music__
01 08094344
00 0a094344
00 08094344
00 0b0c4344
00 13144344
00 12114344
00 0d0e4344
00 0f104344
02 15164344

